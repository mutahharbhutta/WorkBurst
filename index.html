<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="TaskLog - Professional Student Task Management">
  <meta name="theme-color" content="#0f172a">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="TaskLog">

  <title>TaskLog - Student Task Diary</title>

  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="icons/icon-152x152.png">
  <link rel="icon" type="image/png" href="icons/icon-72x72.png">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="style.css" />

  <script src="https://www.gstatic.com/firebasejs/12.3.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/12.3.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/12.3.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/12.3.0/firebase-messaging-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/12.3.0/firebase-storage-compat.js"></script>

</head>

<body>
  <!-- Preloader -->
  <div class="preloader" id="preloader">
    <div class="loader-animation">
      <div class="loader-spinner"></div>
      <div class="loader-text">Loading TaskLog...</div>
      <div class="loader-tip" id="loaderTip">Organize your academic life</div>
    </div>
  </div>

  <!-- Navigation with Analytics -->
  <nav class="navbar">
    <div class="nav-container">
      <a href="index.html" class="nav-brand">
        <span class="brand-icon">ğŸ“‘</span>
        TaskLog
      </a>


      <div class="nav-actions">
        <button class="icon-btn success" id="timetableBtn" title="Timetable">
          <span>ğŸ“…</span>
        </button>

        <div class="theme-selector">
          <button class="icon-btn" id="themeBtn" title="Change Theme">
            <span>ğŸ¨</span>
          </button>
          <div class="theme-dropdown" id="themeDropdown">
            <button data-theme="darkest">Professional Dark</button>
            <button data-theme="classic">Classic Light</button>
            <button data-theme="modern">Modern Slate</button>
          </div>
        </div>

        <button class="icon-btn" id="loginBtn" title="Admin Login">
          <span>ğŸ”</span>
        </button>

        <button class="icon-btn danger admin-only" id="logoutBtn" title="Logout">
          <span>ğŸšª</span>
        </button>
      </div>
    </div>
  </nav>

  <!-- Main Container -->
  <div class="container">
    <!-- PWA Install Banner -->
    <div id="installBanner" class="install-banner" style="display: none;">
      <div class="install-content">
        <div class="install-icon">ğŸ“±</div>
        <div class="install-text">
          <strong>Install TaskLog</strong>
          <p>Add to home screen for quick access</p>
        </div>
      </div>
      <div class="install-actions">
        <button id="installBtn" class="btn primary">Install</button>
        <button id="dismissInstall" class="btn secondary">Later</button>
      </div>
    </div>

    <!-- Hero / Dashboard Header -->
    <div class="hero">
      <h2>Student Diary</h2>
      <p>Manage assignments, quizzes, and academic tasks efficiently.</p>
      <div class="last-updated" id="lastUpdated">
        <!-- <span class="update-icon">ğŸ”„</span> -->
        <span id="updateTime">No updates yet</span>
      </div>
    </div>

    <!-- Filters -->
    <div class="toolbar">
      <div class="search-wrapper">
        <span class="search-icon">ğŸ”</span>
        <input id="search" class="input" placeholder="Search tasks..." />
      </div>
      <div class="select-wrapper">
        <select id="filterType" class="input">
          <option value="all">All Types</option>
          <option>Assignment</option>
          <option>Quiz</option>
          <option>Lab</option>
          <option>Project</option>
          <option>Exam</option>
        </select>
      </div>
    </div>

    <!-- Tasks Section -->
    <section>
      <div id="emptyState" class="empty-state" style="display:none;">
        <div class="icon">ğŸ”­</div>
        <h3>No tasks found</h3>
        <p>Try adjusting your filters or add a new task</p>
      </div>

      <div id="weeklyTasks"></div>
    </section>

    <!-- Admin Panel -->
    <section class="admin-section admin-only">
      <h2 class="section-title">ğŸ“ Admin Panel</h2>

      <!-- Notification Settings -->
      <div class="notification-settings">
        <h3>ğŸ”” Push Notifications</h3>
        <label class="checkbox-label">
          <input type="checkbox" id="enableNotifications" />
          <span>Enable push notifications (12 hours before deadline)</span>
        </label>
        <div id="notificationStatus" style="margin-top: 10px; font-size: 13px; color: var(--text-secondary);">
          Login and enable notifications to see status
        </div>
      </div>

      <form id="itemForm" autocomplete="off">
        <input type="hidden" id="itemId" />

        <div class="field">
          <label>Type</label>
          <select id="type" class="input" required>
            <option>Assignment</option>
            <option>Quiz</option>
            <option>Lab</option>
            <option>Project</option>
            <option>Exam</option>
          </select>
        </div>

        <div class="field">
          <label>Course</label>
          <input id="course" class="input" placeholder="Course name" required />
        </div>

        <div class="field full">
          <label>Title</label>
          <input id="title" class="input" placeholder="Task title" required />
        </div>

        <div class="field">
          <label>Due Date</label>
          <input id="dueDate" type="date" class="input" required />
        </div>

        <div class="field">
          <label>Due Time</label>
          <input id="dueTime" type="time" class="input" />
        </div>

        <div class="field full">
          <label>Link (optional)</label>
          <input id="link" class="input" placeholder="https://..." />
        </div>

        <div class="field full">
          <label>Notes with Images (optional)</label>
          <textarea id="notes" class="input textarea" placeholder="Add your notes here..." rows="4"></textarea>

          <!-- Image Upload Section -->
          <div class="image-upload-section">
            <label for="imageUpload" class="image-upload-label">
              <span class="upload-icon">ğŸ“·</span>
              <span>Add Images to Notes</span>
              <input type="file" id="imageUpload" accept="image/*" multiple style="display: none;" />
            </label>
            <div id="imagePreview" class="image-preview"></div>
          </div>
        </div>

        <div class="form-actions">
          <button type="submit" class="btn primary">ğŸ’¾ Save Task</button>
          <button type="button" id="resetBtn" class="btn secondary">ğŸ”„ Clear</button>
          <button type="button" id="deleteBtn" class="btn danger" style="display:none;">ğŸ—‘ï¸ Delete</button>
        </div>
      </form>

      <div class="table-wrapper">
        <table class="table">
          <thead>
            <tr>
              <th>Type</th>
              <th>Course</th>
              <th>Title</th>
              <th>Due</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="adminTbody"></tbody>
        </table>
      </div>
    </section>
  </div>

  <!-- Task Modal (Expanded View) -->
  <div class="task-modal" id="taskModal">
    <div class="task-modal-content">
      <button class="task-modal-close" id="closeTaskModal">Ã—</button>
      <div id="taskModalBody"></div>
    </div>
  </div>

  <!-- Image Viewer Modal -->
  <div class="image-viewer-modal" id="imageViewerModal">
    <button class="image-viewer-close" id="closeImageViewer">Ã—</button>
    <img id="viewerImage" src="" alt="Full size image" />
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-content">
      <p>Developed by <a href="https://github.com/mutahharbhutta" target="_blank" rel="noopener"
          class="animated-name">Mutahhar Bhutta</a> | Â© 2025</p>
      <p>Crafted with <span class="heart">â¤</span></p>
      <p><a href="https://mutahharbhutta.github.io/pucit-cgpa-calculator/" target="_blank" rel="noopener">PUCIT GPA/CGPA
          Calculator</a> | <a href="https://github.com/mutahharbhutta/ClassSync" target="_blank"
          rel="noopener">GitHub</a></p>
    </div>
  </footer>

  <!-- Login Dialog -->
  <dialog id="loginDialog">
    <h3>ğŸ” Admin Login</h3>
    <p>Use your Firebase credentials to access admin features.</p>
    <input id="email" class="input" placeholder="Email" type="email" />
    <input id="password" type="password" class="input" placeholder="Password" />
    <div class="dialog-actions">
      <button class="btn secondary" id="cancelLogin">Cancel</button>
      <button class="btn primary" id="confirmLogin">Log In</button>
    </div>
  </dialog>

  <script src="app.js"></script>
</body>

</html>